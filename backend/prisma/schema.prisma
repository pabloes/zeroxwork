datasource db {
  provider = "postgresql" // O la base de datos que estés utilizando
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

enum Role {
  ADMIN
  USER
}

model User {
  id       Int      @id @default(autoincrement())
  email    String   @unique
  password String
  role     Role     @default(USER) // Campo para el tipo de usuario
  createdAt DateTime @default(now())
  verified          Boolean  @default(false) // Campo para el estado de verificación
  verificationCode  String?  // Código de verificación de correo
  updatedAt         DateTime @updatedAt
  maxQuota   Int       @default(5242880) // Default max quota in bytes (5 MB)
  fileUploads FileUpload[]  // One-to-many relationship with FileUpload
}

model FileUpload {
  id         Int      @id @default(autoincrement())
  fileName   String
  fileSize   Int
  md5Hash    String?
  sha256Hash String   @unique // Utiliza sha256 como identificador único
  uploadDate DateTime @default(now())
  userId     Int
  analysisId String?  // ID del análisis (opcional si no se usa VirusTotal)
  status     String   @default("pending") // Estado del análisis: pending, completed, dangerous etc.
  dangerous  Boolean  @default(false) // Indica si el archivo es peligroso
  // Relación con User
  user       User     @relation(fields: [userId], references: [id])

  @@index([userId])
  @@index([sha256Hash])
}
